<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shuttle Team Allocator</title>

<link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap" rel="stylesheet">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Comic Neue', cursive;
}

body{
    min-height:100vh;
    background:url("https://images.pexels.com/photos/399187/pexels-photo-399187.jpeg?auto=compress&cs=tinysrgb&w=1920")
    no-repeat center center/cover;
    position:relative;
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
}

body::before{
    content:"";
    position:absolute;
    width:100%;
    height:100%;
    background:linear-gradient(to bottom, rgba(0,0,0,0.4), rgba(0,0,0,0.8));
}

.card{
    width:90%;
    max-width:600px;
    padding:40px 30px;
    border-radius:30px;
    backdrop-filter:blur(18px);
    background:rgba(0,0,0,0.35);
    border:1px solid rgba(255,255,255,0.2);
    box-shadow:0 10px 40px rgba(0,0,0,0.6);
    text-align:center;
}

.title{
    font-size:40px;
    margin-bottom:20px;
}

textarea{
    width:90%;
    height:120px;
    border-radius:15px;
    border:none;
    padding:12px;
    font-size:16px;
    margin-top:10px;
    resize:none;
}

button{
    margin-top:20px;
    padding:14px 30px;
    border:none;
    border-radius:30px;
    background:white;
    color:black;
    font-size:20px;
    cursor:pointer;
}

.teams{
    margin-top:25px;
    text-align:left;
}

.match{
    margin:6px 0;
}
</style>
</head>

<body>

<div class="card">

<div class="title">Shuttle Team Allocator</div>

<p>Enter Player Names (One per line)</p>

<textarea id="players"
placeholder="Player1&#10;Player2&#10;Player3"></textarea>

<br>
<button onclick="allocateTeams()">Allocate Teams</button>

<div class="teams" id="teamOutput"></div>
<div class="teams" id="tournamentOutput"></div>

</div>

<script>

// Shuffle function
function shuffle(arr){
    for(let i = arr.length - 1; i > 0; i--){
        let j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
}

function allocateTeams(){

    let players = document.getElementById("players").value.trim()
        .split("\n")
        .map(p => p.trim())
        .filter(p => p !== "");

    let teamOutput = document.getElementById("teamOutput");
    let tournamentOutput = document.getElementById("tournamentOutput");

    teamOutput.innerHTML = "";
    tournamentOutput.innerHTML = "";

    if(players.length < 2){
        teamOutput.innerHTML = "<p>Enter at least 2 players</p>";
        return;
    }

    // STEP 1 — RANDOMIZE PLAYERS
    shuffle(players);

    // STEP 2 — CREATE TEAMS OF SIZE 2
    let teams = [];
    for(let i=0;i<players.length;i+=2){
        if(i+1 < players.length)
            teams.push([players[i], players[i+1]]);
        else
            teams.push([players[i]]);
    }

    // STEP 3 — DISPLAY TEAMS
    let html = "<h3>Teams</h3>";
    teams.forEach(team=>{
        html += `<p><b>${team.join(" & ")}</b></p>`;
    });
    teamOutput.innerHTML = html;

    // STEP 4 — CREATE ALL MATCHES
    let matches = [];
    for(let i=0;i<teams.length;i++){
        for(let j=i+1;j<teams.length;j++){
            matches.push({
                A: teams[i],
                B: teams[j]
            });
        }
    }

    // STEP 5 — RANDOMIZE MATCH ORDER
    shuffle(matches);

    // STEP 6 — AVOID SAME TEAM IN CONSECUTIVE MATCHES
    let finalMatches = [];

    while(matches.length > 0){

        let indexToPick = 0;

        if(finalMatches.length > 0){
            let last = finalMatches[finalMatches.length - 1];

            for(let i=0;i<matches.length;i++){
                if(
                    matches[i].A !== last.A &&
                    matches[i].A !== last.B &&
                    matches[i].B !== last.A &&
                    matches[i].B !== last.B
                ){
                    indexToPick = i;
                    break;
                }
            }
        }

        finalMatches.push(matches.splice(indexToPick,1)[0]);
    }

    // STEP 7 — DISPLAY MATCHES USING PLAYER NAME
    let matchHTML = "<h3>Tournament Matches</h3>";

    finalMatches.forEach(m=>{
        matchHTML += `
        <div class="match">
        ${m.A[0]} vs ${m.B[0]}
        </div>`;
    });

    tournamentOutput.innerHTML = matchHTML;
}

</script>

</body>
</html>
